using System.Collections.Generic;
using System.Linq;

namespace Restaurant
{
    public class AdminCheck
    {
        private static string accountPath = @".\dataStorage\account.json";

        public static bool IsAdmin(string password, string mail)
        {
            List<User> accounts = JsonUtil.ReadFromJson<User>(accountPath);
            User account = accounts.FirstOrDefault(acc => acc.Email == mail && acc.Password == password && acc.Admin);

            return account != null;
        }
    }
}




using System;

namespace Restaurant
{
    public class LoginProcess
    {
        private static string GivenEmail = "";

        public static void LoginProcessMailView()
        {
            Console.WriteLine("Welcome to Logging in (alpha version)");
            Console.WriteLine("Please enter your Email");
            GivenEmail = Console.ReadLine()!;

            if (!Login.MailMatches(GivenEmail))
            {
                Console.Clear();
                Console.WriteLine("This email is not valid or is not registered yet");
                LoginProcessMailView();
            }

            LoginProcessPasswordView(GivenEmail);
        }

        public static void LoginProcessPasswordView(string email)
        {
            Console.WriteLine("Please enter your password");
            string GivenPW = Console.ReadLine()!;

            if (Login.AccountExists(GivenPW, email))
            {
                bool isAdmin = AdminCheck.IsAdmin(GivenPW, email);

                if (isAdmin)
                {
                    Console.WriteLine("Login successful. Redirecting to admin panel.");
                    AdminMenu.DisplayAdminMenu();
                }
                else
                {
                    Console.WriteLine("Login successful. Heading to the main screen.");
                    Console.WriteLine("Login is succesfull heading to mainscreen");
                    Thread.Sleep(2);
                    Ingelogdmenu.DisplayIngelogdMenu();
                }
            }
            else
            {
                Console.Clear();
                Console.WriteLine("Incorrect password or email combination");
                LoginProcessPasswordView(email);
            }
        }
    }
}




public class User
{
    public string Email { get; set; }
    public string Password { get; set; }
    public string PhoneNumber { get; set; }
    public bool HasReservation { get; set; }
    public List<Table> TableRes { get; set; }
    public bool Admin { get; set; }
}



public void CreateAccount(string Email, string Password, string PhoneNumber, bool isAdmin)
{
    string email = Email;
    string password = Password;
    string phonenumber = PhoneNumber;
    bool adminStatus = isAdmin;

    List<User> acc = JsonUtil.ReadFromJson<User>(accountPath)!;
    var account = new User { Email = email, Password = password, PhoneNumber = phonenumber, Admin = adminStatus };
    acc.Add(account);
    JsonUtil.UploadToJson(acc, accountPath);
}



public static void RegisterProcessView()
{
    Registration REG = new Registration();


    Console.WriteLine("Are you an admin? (true/false)");
    bool isAdmin = Convert.ToBoolean(Console.ReadLine()!);

    REG.CreateAccount(GivenEmail, GivenPW, PhoneNR!, isAdmin);

}
